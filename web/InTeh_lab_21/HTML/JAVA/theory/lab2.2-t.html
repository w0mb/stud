<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//RU">
<HTML>
<HEAD>
<TITLE>Теория к лаб. работе N 2.5</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1251">
<link REL="stylesheet" TYPE="text/css" HREF="mstyle.css">
</HEAD>
<body>

<h2>Функции setTimeout и clearTimeout</h2>
<h3>Метод setTimeout</h3>
<p>С помощью метода setTimeout вы можете установить таймер, указав при этом выражение JavaScript и задержку во времени:</p>

<table><tr><td bgcolor=aqua><pre>
idTimer=setTimeout(cmd, timeout);</pre></td></tr></table><br>

<p>Метод setTimeout создает и запускает таймер, возвращая его идентификатор. Когда пройдет время, заданное вторым параметром timeout (в миллисекундах), запускается выражение JavaScript, заданное параметром cmd.</p>
<p>Рассмотрим такой фрагмент сценария:</p>

<table><tr><td bgcolor=aqua><pre>
var cmd="NoAccess()";
idTimer=window.setTimeout(cmd, 10000);</pre></td></tr></table><br>

<p>Здесь мы создаем таймер с временем задержки 10 секунд. После прошествия этого времени будет вызвана функция с именем NoAccess, которая должна быть определена в сценарии заранее. Эта функция будет выполнена только один раз.</p>

<p>Одно из применений метода setTimeout - создание анимационных эффектов в сценарии JavaScript. Допустим, имеется набор картинок img_x.gif, где x - порядковый номер картинки. Для того, чтобы периодически менять изображение, создавая эффект анимации,
достаточно использовать следующий код:</p>

<table><tr><td bgcolor=aqua><pre>
&lt;img name="animation" src="img_1.gif" onLoad="setTimeout('animate()', delay)"&gt;</pre></td></tr></table><br>

<p>Новое для нас здесь - обработка события <strong>Load</strong>, происходящего после полной загрузки изображения.
Таким образом, после загрузки изображения с помощью setTimeout указывается, что по прошествии delay милисекунд должна
вызваться функция <strong>animate()</strong>. В этой функции достаточно изменить свойство <strong>src</strong> 
объекта-картинки <strong>animation</strong> для указания следующего изображения. Когда это изображение загрузится, 
опять произойдет событие <strong>Load</strong>, вновь установится таймер вызовом setTimeout и т.д.

<h3>Метод clearTimeout</h3>

<p>С помощью метода clearTimeout можно остановить таймер, запущенный только что рассмотренным методом setTimeout. В качестве параметра методу clearTimeout необходимо передать идентификатор таймера, полученный от метода setTimeout:</p>

<table><tr><td bgcolor=aqua><pre>
clearTimeout(idTimer);</pre></td></tr></table><br>


<h2>Объект Event</h2>

<p>Каждое событие имеет ассоциированный объект event. 
Объект event предоставляет информацию о событии, такую как тип события и 
положение курсора в момент возникновения события. Когда событие возникает, 
и если обработчик был написан для обработки этого события, объект event отправляется 
обработчику как аргумент.</p>

<p>В случае с событием MouseDown, например, объект event содержит тип события ("MouseDown"), 
координаты x и y позиции курсора мыши в момент возникновения события, 
число - используемую кнопку мыши (свойство button) и поле, содержащее клавиши-модификаторы 
(Control, Alt, Meta или Shift), которые были нажаты в момент события. 
Свойства объекта event различаются для разных типов событий.</p>

<p>Наиболее часто используемы свойства объекта Event:</p>

<TABLE border="1">
<TBODY>
<TR>
<TD><STRONG>Свойство</STRONG></TD>
<TD><STRONG>Описание</STRONG></TD></TR>
<TR>
<TD><EM>Data</EM></TD>
<TD>Массив адресов URL оставленных объектов, когда происходит событие <EM>DragDrop</EM>.</TD></TR>
<TR>
<TD><EM>LayerX</EM></TD>
<TD>Горизонтальное положение курсора (в пикселах) относительно слоя. В комбинации с событием Resize это свойство представляет ширину окна браузера.</TD></TR>
<TR>
<TD><EM>LayerY</EM></TD>
<TD>Вертикальное положение курсора (в пикселах) относительно слоя. В комбинации с событием Resize это свойство представляет высоту окна браузера.</TD></TR>
<TR>
<TD><EM>modifiers</EM></TD>
<TD>Строка, задающая ключи модификатора - <EM>ALT_MASK</EM>, <EM>CONTROL_MASK</EM>, <EM>META_MASK</EM> or <EM>SHIFT_MASK</EM></TD></TR>
<TR>
<TD><EM>pageX</EM></TD>
<TD>Горизонтальное положение курсора (в пикселах) относительно окна браузера.</TD></TR>
<TR>
<TD><EM>pageY</EM></TD>
<TD>Вертикальное положение курсора (в пикселах) относительно окна браузера.</TD></TR>
<TR>
<TD><EM>screenX</EM></TD>
<TD>Горизонтальное положение курсора (в пикселах) относительно экрана.</TD></TR>
<TR>
<TD><EM>screenY</EM></TD>
<TD>Вертикальное положение курсора (в пикселах) относительно экрана.</TD></TR>
<TR>
<TD><EM>target</EM></TD>
<TD>Строка, представляющая объект, которому исходно было послано событие.</TD></TR>
<TR>
<TD><EM>type</EM></TD>
<TD>Строка, указывающая тип события.</TD></TR>
<TR>
<TD><EM>which</EM></TD>
<TD>ASCII-значение нажатой клавиши или номер клавиши мыши.</TD></TR>
<TR>
<TD><EM>x</EM></TD>
<TD>Синоним <EM>layerX</EM>.</TD></TR>
<TR>
<TD><EM>y</EM></TD>
<TD>Синоним <EM>layerY</EM>.</TD></TR></TBODY></TABLE>

<h2>Добавление возможности перемещения</h2>

<p>Комбинируя абсолютное позиционирование с событиями мыши, можно моделировать перемещение элементов с помощью мыши. Для добавления поддержки перемещения элементов с помощью мыши можно написать сценарий, который ищет атрибут dragEnabled во всех элементах. Грамотно написанный сценарий автоматически обрабатывает перемещения всех элементов, которые имеют данный атрибут, включая вложенные позиционированные элементы, так что код не требуется изменять при каждом добавлении элемента, доступного для перемещения. Если пользователь удерживает кнопку мыши нажатой на элементе, для которого установлен атрибут dragEnabled, а затем перемещает мышь, то элемент будет перемещаться, следуя за перемещением мыши. Другим методом является использование специального имени класса вместо атрибута dragEnabled.</p>
<p>Одним из способов динамического изменения положения объекта являются 
CSS свойства pixelTop и pixelLeft с заданием абсолютного позицинирования.</p>

<table><tr><td bgcolor=aqua><pre>
&lt;IMG name="img_name" SRC="img.gif" dragEnabled STYLE="position:absolute; top:110px; left:10px; cursor:hand;"&gt;</pre></td></tr></table><br>

<p>Для того, чтобы получить доступ к свойствам top и left, можно использовать следующий код:</p>

<table><tr><td bgcolor=aqua><pre>
img_name.style.pixelTop=50;
img_name.style.pixelLeft=200;</pre></td></tr></table><br>

<br>

<h2>Объект Image</h2>

<p>
Давайте сначала рассмотрим, как из JavaScript можно адресоваться к изображениям, представленным на web-странице. В рассматриваемом языке все изображения предстают в виде массива. Массив этот называется <b><i>images</i></b> и является свойством объекта document. Каждое изображение на web-странице получает порядковый номер: первое изображение получает номер 0, второе - номер 1 и т.д. Таким образом, к первому изображению мы можем адресоваться записав document.images[0].
<br>
<br>
Каждое изображение в HTML-документе рассматривается в качестве объекта Image. Объект Image имеет определенные свойства, к которым и можно обращаться из языка JavaScript. Например, Вы можете определить, который размер имеет изображение, обратившись к его свойствам <b><i>width</i></b> и <b><i>height</i></b>. То есть по записи <table><td bgcolor="aqua"><tt>document.images[0].width</td></tr></table> Вы можете определить ширину первого изображения на web-странице (в пикселах).
<br>
<br>

К сожалению, отслеживать индекс всех изображений может оказаться затруднительным, особенно если на одной странице у Вас их довольно много. Эта проблема решается назначением изображениям своих собственных имен. Так, если Вы заводите изображение с помощью тэга
<p>
<table><tr><td bgcolor="aqua">
<tt>&lt;img src="img.gif" name="myImage" width=100 height=100><p>
</td></tr></table>
<br>
то Вы сможете обращаться к нему, написав <table><tr><td bgcolor="aqua"><tt>document.myImage</td></tr></table> или 
<table><tr><td bgcolor="aqua">
<tt>document.images["myImage"]</td></tr></table>
<br>
<p>

<font size=+1>

Загрузка новых изображений 
</font>
<p>

Хотя конечно и хорошо знать, как можно получить размер изображения на web-странице, это не совсем то, чего бы мы хотели. Мы хотим осуществлять смену изображений на web-странице и для этого нам понадобится атрибут <i>src</i>. Как и в случае тэга &lt;img>, атрибут <b><i>src</i></b> содержит адрес представленного изображения. В языке JavaScript - Вы имеете возможность назначать новый адрес изображению, уже загруженному в web-страницу. И в результате, изображение будет загружено с этого нового адреса, заменив на web-странице старое. Рассмотрим к примеру запись:
<p>
<table><tr><td bgcolor="aqua">
<tt>&lt;img src="img1.gif" name="myImage" width=100 height=100></tt><p>
</td></tr></table>
Здесь загружается изображение <b><i>img1.gif</i></b> и получает имя <b><i>myImage</i></b>. В следующей строке прежнее изображение <b><i>img1.gif</i></b> заменяется уже на новое - <b><i>img2.gif</i></b>:<p>
<table><tr><td bgcolor="aqua">
<tt>document.myImage.src= "img2.src";</tt><p>
</td></tr></table>
<br>
При этом новое изображение всегда получает тот же размер, что был у старого. И Вы уже не можете изменить размер поля, в котором это изображение размещается.
<p>

<p>
<font size=+1>Упреждающая загрузка изображения</font>

<p>

Один из недостатков такого подхода может заключаться в том, что <i>после</i> записи в <i>src</i> нового адреса начинает процесс загрузки соответствующего изображения. И поскольку этого не было сделано заранее, то еще пройдет некоторое время, прежде чем новое изображение будет передано через Интернет и встанет на свое место. В некоторых ситуациях это допустимо, однако часто подобные задержки неприемлемы. И что же мы можем сделать с этим? Конечно, решением проблемы была бы упреждающая загрузка изображения. Для этого мы должны создать новый объект Image. Рассмотрим следующие строки:
<p>
<table><tr><td bgcolor="aqua">
<pre>
hiddenImg= new Image();
hiddenImg.src= "img3.gif";
</pre>
</td></tr></table>
<br>
В первой строке создается новый объект Image. Во второй строке указывается адрес изображения, которое в дальнейшем будет представлено с помощью объекта  <b><i>hiddenImg</i></b>. Как мы уже видели, запись нового адреса в атрибуте <b><i>src</i></b> заставляет браузер загружать изображение с указанного адреса. Поэтому, когда выполняется вторая строка нашего примера, начинает загружаться изображение <b><i>img2.gif</i></b>. Но как подразумевается самим названием <b><i>hiddenImg</i></b> ("скрытая картинка"), после того, как браузер закончит загрузку, изображение на экране не появится. Оно будет лишь будет сохранено в памяти компьютера (или точнее в кэше) для последующего использования. Чтобы вызвать изображение на экран, мы можем воспользоваться строкой:
<br>
<p>
<table><tr><td bgcolor="aqua">
<tt>document.myImage.src= hiddenImg.src;</tt><p>
</td></tr></table>
<br>
Но теперь изображение уже немедленно извлекается из кэша и показывается на экране. Таким образом, сейчас мы управляли упреждающей загрузкой изображения. 
<br>

Конечно браузер должен был к моменту запроса закончить упреждающую загрузку, чтобы необходимое изображение было показано без задержки. Поэтому, если Вы должны предварительно загрузить большое количество изображений, то может иметь место задержка, поскольку браузер будет занят загрузкой всех картинок. Вы всегда должны учитывать скорость связи с Интернет - загрузка изображений не станет быстрее, если пользоваться только что показанными командами. Мы лишь пытаемся чуть раньше загрузить изображение - поэтому и пользователь может увидеть их раньше. В результате и весь процесс пройдет более гладко.
<br>
<p>

<font size=+1>
Изменение изображений в связи с событиями, инициируемыми самим читателем 
</font>

<p>

Вы можете создать красивые эффекты, используя смену изображений в качестве реакции на определенные события. Например, Вы можете изменять изображения в тот момент, когда курсор мыши попадает на определенную часть страницы.  Проверьте, как работает следующий пример, просто поместив курсор мыши на картинку .
<p>

<a href="#" 
  onMouseOver="document.myImage2.src='img2.gif'" 
  onMouseOut="document.myImage2.src='img1.gif'">
<img src="img1.gif" name="myImage2" width=160 height=50 border=0></a>

<p>

Исходный код этого примера выглядит следующим образом:<br>
<table><tr><td bgcolor="aqua">
<pre>
&lt;a href="#" 
  onMouseOver="document.myImage2.src='img2.gif'" 
  onMouseOut="document.myImage2.src='img1.gif'">
&lt;img src="img1.gif" name="myImage2" width=160 height=50 border=0>&lt;/a>

</pre>
</td></tr></table><br>

Также, объекты Image поддерживают события MouseOver (наведение мыши на изображение)
 и MouseOut (выход указателя мыши за пределы изображения).


</body>
</html>